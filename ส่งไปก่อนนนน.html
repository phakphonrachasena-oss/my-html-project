<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üåø GreenSync Duel ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Noto+Sans+Thai:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
<style>
  :root{
    --bg:#f5f7fa;--text:#1f2430;--muted:#667085;--card:#fff;--border:#e5e7eb;
    --primary:#10b981;--primary-light:#d1fae5;--primary-dark:#047857;
    --secondary:#8b5cf6;--accent:#f59e0b;
  }
  .theme-kid{--bg:#e0f7fa;--text:#01579b;--muted:#4dd0e1;--card:#fff;--border:#b2ebf2;--primary:#00bcd4;--primary-light:#b2ebf2;--primary-dark:#00838f;--secondary:#ff4081;--accent:#ffc107;}
  .theme-teen{--bg:#f3e5f5;--text:#4a148c;--muted:#8e24aa;--card:#fff;--border:#e1bee7;--primary:#9c27b0;--primary-light:#e1bee7;--primary-dark:#6a1b9a;--secondary:#ff9800;--accent:#4caf50;}
  .theme-adult{--bg:#f5f5f5;--text:#212121;--muted:#757575;--card:#fff;--border:#e0e0e0;--primary:#455a64;--primary-light:#cfd8dc;--primary-dark:#263238;--secondary:#607d8b;--accent:#ff5722;}
  .theme-cny{--bg:#fff9f9;--text:#b71c1c;--muted:#d32f2f;--card:#fff;--border:#ffcdd2;--primary:#d32f2f;--primary-light:#ffcdd2;--primary-dark:#b71c1c;--secondary:#ffc107;--accent:#4caf50;}
  .theme-valentine{--bg:#fff5f7;--text:#880e4f;--muted:#ad1457;--card:#fff;--border:#f8bbd9;--primary:#e91e63;--primary-light:#f8bbd9;--primary-dark:#ad1457;--secondary:#ec407a;--accent:#ab47bc;}
  .theme-newyear{--bg:#f0f8ff;--text:#0d47a1;--muted:#1565c0;--card:#fff;--border:#bbdefb;--primary:#0d47a1;--primary-light:#bbdefb;--primary-dark:#002171;--secondary:#ff6d00;--accent:#00c853;}

  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,"Noto Sans Thai",system-ui;transition:.3s}
  .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
  .h1{font-weight:700;font-size:28px}
  .muted{color:var(--muted)}
  .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);margin-bottom:16px;transition:.3s}
  .hd{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:600;background:var(--primary-light);color:var(--primary-dark)}
  .bd{padding:14px 16px}
  label{display:block;margin-bottom:6px;font-size:14px}
  input,select{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:10px;transition:.2s}
  input:focus,select:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px var(--primary-light)}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .btn{display:inline-flex;gap:8px;align-items:center;border-radius:999px;padding:10px 16px;border:1px solid var(--primary);background:var(--primary);color:#fff;cursor:pointer;font-weight:600;transition:.2s}
  .btn:hover{background:var(--primary-dark);transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,.1)}
  .btn.ghost{background:#fff;color:var(--primary-dark)}
  .btn.danger{background:#ef4444;border-color:#ef4444;color:#fff}
  .btn.danger:hover{background:#dc2626}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  @media(max-width:900px){.row{grid-template-columns:1fr}.grid2{grid-template-columns:1fr}}
  .kpi{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:8px}
  .kpi .it{background:#f8fafc;border:1px solid var(--border);border-radius:12px;padding:8px 10px}
  .kpi .v{font-weight:700}
  .hearts{font-size:28px;line-height:1.1;color:#e91e63;word-break:break-word}
  .special-hearts{font-size:24px;line-height:1.1;word-break:break-word;margin-top:4px}
  table{width:100%;border-collapse:collapse}
  th,td{padding:6px 8px;border-bottom:1px solid var(--border);font-size:13px}
  thead th{background:#f8fafc}
  .flex{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
  .badge{display:inline-flex;align-items:center;gap:6px;padding:4px 8px;border-radius:999px;background:var(--primary-light);color:var(--primary-dark);font-weight:600;font-size:12px}
  .err{color:#b91c1c;font-weight:600}
  .ok{color:#047857;font-weight:600}
  .chips{display:flex;gap:8px;flex-wrap:wrap}
  .chip{padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#fff}
  .sub{font-size:12px;color:var(--muted)}
  .sp{display:inline-flex;align-items:center;gap:8px}
  .dot{width:10px;height:10px;border-radius:999px;background:#9ca3af;display:inline-block}
  .dot.ok{background:#10b981}.dot.fail{background:#ef4444}.dot.load{background:#f59e0b}
  .spinner{width:18px;height:18px;border:3px solid #e5e7eb;border-top-color:var(--primary);border-radius:50%;animation:spin 1s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
  .hero{display:flex;align-items:center;gap:12px}
  .mascot{width:64px;height:64px}
  .teamBadge{display:flex;align-items:center;gap:8px}
  .teamIcon{width:18px;height:18px}

  /* Status badges */
  .status-badge { display: inline-flex; align-items: center; gap: 4px; padding: 2px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; }
  .status-excellent { background: #dcfce7; color: #166534; }
  .status-good { background: #dbeafe; color: #1e40af; }
  .status-fair { background: #fef3c7; color: #92400e; }
  .status-poor { background: #fecaca; color: #991b1b; }
  .status-critical { background: #fecaca; color: #991b1b; }

  /* AI Advice Styles */
  .ai-advice { 
    background: #f8fafc; 
    border-left: 4px solid var(--primary); 
    padding: 12px; 
    border-radius: 8px; 
    margin-top: 12px; 
    transition: all 0.3s ease;
  }
  .ai-advice.collapsed {
    max-height: 60px;
    overflow: hidden;
    cursor: pointer;
  }
  .ai-advice.expanded {
    max-height: 500px;
    overflow-y: auto;
  }
  .ai-advice-header { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    margin-bottom: 8px; 
    cursor: pointer;
  }
  .ai-advice-header h4 { 
    margin: 0; 
    color: var(--primary-dark); 
    display: flex; 
    align-items: center; 
    gap: 8px;
  }
  .ai-advice-toggle {
    background: none;
    border: none;
    color: var(--primary);
    cursor: pointer;
    padding: 4px;
    border-radius: 4px;
    transition: background 0.2s;
  }
  .ai-advice-toggle:hover {
    background: var(--primary-light);
  }
  .ai-advice-content { 
    white-space: pre-line; 
    line-height: 1.5; 
    font-size: 14px;
  }
  .ai-advice.collapsed .ai-advice-content {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  /* Real-time update indicator */
  .real-time-update {
    animation: pulse 2s infinite;
    color: var(--primary);
    font-size: 12px;
    font-weight: normal;
  }
  @keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
  }
</style>
</head>
<body>
<div class="wrap">
  <!-- Header -->
  <div class="card">
    <div class="bd flex" style="justify-content:space-between">
      <div class="hero">
        <svg class="mascot" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <linearGradient id="g1" x1="0" x2="0" y1="0" y2="1">
              <stop offset="0%" stop-opacity="1" stop-color="#34d399"/>
              <stop offset="100%" stop-opacity="1" stop-color="#10b981"/>
            </linearGradient>
          </defs>
          <circle cx="64" cy="64" r="62" fill="#ecfdf5" stroke="#a7f3d0" stroke-width="4"/>
          <path d="M64 72c-14 0-22-10-22-22 10 0 18 4 22 10 4-6 12-10 22-10 0 12-8 22-22 22z" fill="url(#g1)"/>
          <rect x="36" y="76" width="56" height="26" rx="8" fill="#f59e0b"/>
          <rect x="42" y="82" width="44" height="6" rx="3" fill="#fed7aa"/>
          <rect x="48" y="92" width="32" height="6" rx="3" fill="#fed7aa"/>
        </svg>
        <div>
          <div class="h1">üåø GreenSync ‚Äî ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ</div>
          <div class="muted" id="headerSubtitle">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå | ‡∏ó‡∏µ‡∏° A vs ‡∏ó‡∏µ‡∏° B</div>
        </div>
      </div>
      <div class="flex">
        <button class="btn ghost" id="btnEditProfile" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå" style="display:none"><i class="fa-solid fa-user-pen"></i> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</button>
        <select id="theme" title="‡∏ò‡∏µ‡∏°">
          <option value="default">‡∏ò‡∏µ‡∏°‡∏õ‡∏Å‡∏ï‡∏¥</option>
          <option value="kid">‡∏ò‡∏µ‡∏°‡πÄ‡∏î‡πá‡∏Å</option>
          <option value="teen">‡∏ò‡∏µ‡∏°‡∏ß‡∏±‡∏¢‡∏£‡∏∏‡πà‡∏ô</option>
          <option value="adult">‡∏ò‡∏µ‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà</option>
          <option value="cny">‡∏ò‡∏µ‡∏°‡∏ï‡∏£‡∏∏‡∏©‡∏à‡∏µ‡∏ô</option>
          <option value="valentine">‡∏ò‡∏µ‡∏°‡∏ß‡∏≤‡πÄ‡∏•‡∏ô‡πÑ‡∏ó‡∏ô‡πå</option>
          <option value="newyear">‡∏ò‡∏µ‡∏°‡∏õ‡∏µ‡πÉ‡∏´‡∏°‡πà</option>
        </select>
        <span class="badge"><i class="fa-solid fa-clock"></i> <span id="nowTH">‚Äî</span></span>
      </div>
    </div>
  </div>

  <!-- NAV -->
  <div class="flex" style="margin:0 0 12px 2px">
    <button class="btn ghost" id="navForm"><i class="fa-regular fa-rectangle-list"></i> ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
    <button class="btn ghost" id="navDash"><i class="fa-solid fa-gauge"></i> ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
    <button class="btn ghost" id="navInsight"><i class="fa-solid fa-heart-pulse"></i> ‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å</button>
    <button class="btn ghost" id="navDailyScores"><i class="fa-solid fa-trophy"></i> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</button>
    <span class="muted" id="profileBadge" style="display:none"><i class="fa-solid fa-circle-check"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡πâ‡∏ß</span>
    <button class="btn danger ghost" id="btnReset" style="margin-left:auto"><i class="fa-solid fa-rotate-left"></i> ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
    <button class="btn danger ghost" id="btnClearURL" style="display:none"><i class="fa-solid fa-broom"></i> ‡∏•‡πâ‡∏≤‡∏á URL</button>
  </div>

  <!-- FORM -->
  <div class="card" id="secForm">
    <div class="hd">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå & ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</div>
    <div class="bd">
      <div class="row">
        <div>
          <label>Web App URL (‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡∏° A/B) ‚Äî ‡∏•‡∏á‡∏ó‡πâ‡∏≤‡∏¢ /exec</label>
          <input id="webapp" placeholder="https://script.google.com/macros/s/DEPLOYMENT_ID/exec">
        </div>
        <div>
          <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ñ‡∏ß (limit)</label>
          <select id="limit"><option>10</option><option>30</option><option selected>50</option><option>100</option></select>
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <div>
          <label>‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î Web App ‡πÅ‡∏¢‡∏Å‡∏ó‡∏µ‡∏° (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) ‚Äî ‡∏ó‡∏µ‡∏° A</label>
          <input id="webappA" placeholder="‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ URL ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô">
        </div>
        <div>
          <label>‡∏ó‡∏µ‡∏° B</label>
          <input id="webappB" placeholder="‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ URL ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô">
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <div>
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏° A</label>
          <input id="teamNameA" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏° A" value="‡∏ó‡∏µ‡∏° A">
        </div>
        <div>
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏° B</label>
          <input id="teamNameB" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏° B" value="‡∏ó‡∏µ‡∏° B">
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <div>
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ</label>
          <input id="plant" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏¢‡∏≤‡∏á‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢ / ‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πà‡∏≤" value="‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πà‡∏≤">
        </div>
        <div>
          <label>‡∏Ç‡∏ô‡∏≤‡∏î‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å</label>
          <input id="size" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2 x 3 ‡πÄ‡∏°‡∏ï‡∏£" value="1.5 x 2 ‡πÄ‡∏°‡∏ï‡∏£">
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <div>
          <label>‡πÅ‡∏™‡∏á</label>
          <select id="lightCond"><option>‡∏û‡∏≠‡∏°‡∏≤‡∏Å</option><option selected>‡∏û‡∏≠‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì</option><option>‡∏ô‡πâ‡∏≠‡∏¢/‡∏≠‡∏±‡∏ö‡πÅ‡∏™‡∏á</option></select>
        </div>
        <div>
          <label>‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡πÄ‡∏ó‡∏≠‡∏≤‡∏Å‡∏≤‡∏®</label>
          <select id="airflow"><option>‡πÇ‡∏õ‡∏£‡πà‡∏á</option><option selected>‡∏û‡∏≠‡πÉ‡∏ä‡πâ</option><option>‡∏≠‡∏±‡∏ö</option></select>
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <div>
          <label>‡πÅ‡∏≠‡∏£‡πå</label>
          <select id="ac"><option>‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô</option><option selected>‡∏ö‡∏≤‡∏á‡πÄ‡∏ß‡∏•‡∏≤</option><option>‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î</option></select>
        </div>
        <div>
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏õ‡∏•‡∏π‡∏Å (‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏£‡πà‡∏ß‡∏° A/B)</label>
          <input id="name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏£‡∏π‡∏£‡∏±‡∏ä‡∏û‡∏•" value="‡∏ó‡∏µ‡∏° GreenSync">
        </div>
      </div>

      <div class="row" style="margin-top:8px">
        <div>
          <label>‡∏£‡∏≠‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</label>
          <select id="interval"><option>10</option><option selected>20</option><option>30</option><option>60</option></select>
        </div>
        <div>
          <label>‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏î‡∏™‡∏≠‡∏ö</label>
          <select id="demo"><option value="off">‡∏õ‡∏¥‡∏î</option><option value="on" selected>‡πÄ‡∏õ‡∏¥‡∏î</option></select>
        </div>
      </div>

      <div style="margin-top:12px" class="flex">
        <button class="btn" id="btnStart"><i class="fa-solid fa-play"></i> ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô ‚ûú ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
        <span id="status" class="muted sp"><span class="dot" id="dot"></span><span id="statusText"></span></span>
        <button class="btn ghost" id="btnTest"><i class="fa-solid fa-plug"></i> ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</button>
      </div>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div class="card" id="secDash" style="display:none">
    <div class="hd">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î 2 ‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á (<span id="teamALabel">‡∏ó‡∏µ‡∏° A</span> vs <span id="teamBLabel">‡∏ó‡∏µ‡∏° B</span>) - ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå: <span id="plantLabel">‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πà‡∏≤</span></div>
    <div class="bd grid2">
      <!-- LEFT -->
      <div>
        <div class="flex" style="justify-content:space-between">
          <div class="teamBadge">
            <svg class="teamIcon" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="#86efac"/><path d="M12 6c-3 0-4 2-4 4 2 0 3 .5 4 2 1.1-1.5 2-2 4-2 0-2-1-4-4-4z" fill="#16a34a"/></svg>
            <div class="muted" id="teamAName">‡∏ó‡∏µ‡∏° A</div>
          </div>
          <div class="badge"><i class="fa-solid fa-database"></i> <span id="dsA">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span></div>
        </div>
        <div class="kpi" style="margin-top:8px">
          <div class="it"><div>Temp (¬∞C)</div><div class="v" id="a_temp">-</div></div>
          <div class="it"><div>Humid (%)</div><div class="v" id="a_hum">-</div></div>
          <div class="it"><div>Soil (%)</div><div class="v" id="a_soil">-</div></div>
          <div class="it"><div>Light (%)</div><div class="v" id="a_light">-</div></div>
        </div>
        <div style="margin-top:8px">
          <div class="flex">
            <span>‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ:</span>
            <span id="a_status" class="status-badge status-fair">‚Äî</span>
          </div>
          <div class="hearts" id="a_hearts">‚Äî</div>
          <div class="special-hearts" id="a_special_hearts"></div>
        </div>
        <div class="muted" id="a_advice" style="margin-top:6px">‚Äî</div>
        
        <!-- AI Advice for Team A -->
        <div id="aiAdviceDashA" class="ai-advice collapsed" style="margin-top:12px; display:none">
          <div class="ai-advice-header">
            <h4><i class="fa-solid fa-robot"></i> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI <span class="real-time-update" id="aiUpdateIndicatorDashA">‚Ä¢ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</span></h4>
            <button class="ai-advice-toggle" title="‡∏û‡∏±‡∏ö/‡∏Ç‡∏¢‡∏≤‡∏¢">
              <i class="fa-solid fa-chevron-down"></i>
            </button>
          </div>
          <div id="aiAdviceContentDashA" class="ai-advice-content"></div>
        </div>
        
        <table style="margin-top:10px">
          <thead><tr><th style="text-align:left">‡πÄ‡∏ß‡∏•‡∏≤</th><th>Temp</th><th>RH</th><th>Soil</th><th>Light</th></tr></thead>
          <tbody id="a_tbl"></tbody>
        </table>
      </div>

      <!-- RIGHT -->
      <div>
        <div class="flex" style="justify-content:space-between">
          <div class="teamBadge">
            <svg class="teamIcon" viewBox="0 0 24 24"><rect x="2" y="2" width="20" height="20" rx="6" fill="#93c5fd"/><path d="M12 6c-3 0-4 2-4 4 2 0 3 .5 4 2 1.1-1.5 2-2 4-2 0-2-1-4-4-4z" fill="#2563eb"/></svg>
            <div class="muted" id="teamBName">‡∏ó‡∏µ‡∏° B</div>
          </div>
          <div class="badge"><i class="fa-solid fa-database"></i> <span id="dsB">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span></div>
        </div>
        <div class="kpi" style="margin-top:8px">
          <div class="it"><div>Temp (¬∞C)</div><div class="v" id="b_temp">-</div></div>
          <div class="it"><div>Humid (%)</div><div class="v" id="b_hum">-</div></div>
          <div class="it"><div>Soil (%)</div><div class="v" id="b_soil">-</div></div>
          <div class="it"><div>Light (%)</div><div class="v" id="b_light">-</div></div>
        </div>
        <div style="margin-top:8px">
          <div class="flex">
            <span>‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ:</span>
            <span id="b_status" class="status-badge status-fair">‚Äî</span>
          </div>
          <div class="hearts" id="b_hearts">‚Äî</div>
          <div class="special-hearts" id="b_special_hearts"></div>
        </div>
        <div class="muted" id="b_advice" style="margin-top:6px">‚Äî</div>
        
        <!-- AI Advice for Team B -->
        <div id="aiAdviceDashB" class="ai-advice collapsed" style="margin-top:12px; display:none">
          <div class="ai-advice-header">
            <h4><i class="fa-solid fa-robot"></i> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI <span class="real-time-update" id="aiUpdateIndicatorDashB">‚Ä¢ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</span></h4>
            <button class="ai-advice-toggle" title="‡∏û‡∏±‡∏ö/‡∏Ç‡∏¢‡∏≤‡∏¢">
              <i class="fa-solid fa-chevron-down"></i>
            </button>
          </div>
          <div id="aiAdviceContentDashB" class="ai-advice-content"></div>
        </div>
        
        <table style="margin-top:10px">
          <thead><tr><th style="text-align:left">‡πÄ‡∏ß‡∏•‡∏≤</th><th>Temp</th><th>RH</th><th>Soil</th><th>Light</th></tr></thead>
          <tbody id="b_tbl"></tbody>
        </table>
      </div>
    </div>
    <div class="bd" style="display:flex;gap:8px;flex-wrap:wrap">
      <button class="btn" id="btnGoInsights"><i class="fa-solid fa-heart-pulse"></i> ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å</button>
      <button class="btn ghost" id="btnRefresh"><i class="fa-solid fa-rotate"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      <button class="btn ghost" id="btnGetAIAdvice"><i class="fa-solid fa-robot"></i> ‡∏Ç‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI</button>
    </div>
  </div>

  <!-- INSIGHTS -->
  <div class="card" id="secInsights" style="display:none">
    <div class="hd">‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å: ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏™‡∏∞‡∏™‡∏° + ‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° & ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û - ‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå: <span id="plantLabelInsights">‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πà‡∏≤</span></div>
    <div class="bd">
      <div class="chips">
        <span class="chip">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô = ‡∏£‡∏π‡∏õ‡∏´‡∏±‡∏ß‡πÉ‡∏à (1‚Äì10)</span>
        <span class="chip">PM2.5 ‡πÉ‡∏ä‡πâ ¬µg/m¬≥</span>
      </div>
      <div style="margin:12px 0">
        <canvas id="chartHearts" height="120"></canvas>
      </div>

      <div class="grid2" style="margin-top:12px">
        <div class="card" style="margin:0">
          <div class="hd" id="teamAHealthHeader">‡∏ó‡∏µ‡∏° A ‚Äî ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
          <div class="bd">
            <div id="healthA">‚Äî</div>
            <div id="aiAdviceA" class="ai-advice collapsed" style="display:none">
              <div class="ai-advice-header">
                <h4><i class="fa-solid fa-robot"></i> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI <span class="real-time-update" id="aiUpdateIndicatorA">‚Ä¢ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</span></h4>
                <button class="ai-advice-toggle" title="‡∏û‡∏±‡∏ö/‡∏Ç‡∏¢‡∏≤‡∏¢">
                  <i class="fa-solid fa-chevron-down"></i>
                </button>
              </div>
              <div id="aiAdviceContentA" class="ai-advice-content"></div>
            </div>
          </div>
        </div>
        <div class="card" style="margin:0">
          <div class="hd" id="teamBHealthHeader">‡∏ó‡∏µ‡∏° B ‚Äî ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
          <div class="bd">
            <div id="healthB">‚Äî</div>
            <div id="aiAdviceB" class="ai-advice collapsed" style="display:none">
              <div class="ai-advice-header">
                <h4><i class="fa-solid fa-robot"></i> ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI <span class="real-time-update" id="aiUpdateIndicatorB">‚Ä¢ ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå</span></h4>
                <button class="ai-advice-toggle" title="‡∏û‡∏±‡∏ö/‡∏Ç‡∏¢‡∏≤‡∏¢">
                  <i class="fa-solid fa-chevron-down"></i>
                </button>
              </div>
              <div id="aiAdviceContentB" class="ai-advice-content"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="grid2" style="margin-top:12px">
        <div>
          <div class="h1" style="font-size:18px;margin:0 0 6px">‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</div>
          <div id="dailyTable" class="sub">‚Äî</div>
        </div>
        <div>
          <div class="h1" style="font-size:18px;margin:0 0 6px">‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</div>
          <div id="weeklyTable" class="sub">‚Äî</div>
        </div>
      </div>

      <div class="flex" style="margin-top:12px">
        <button class="btn ghost" id="btnBackDash"><i class="fa-solid fa-gauge"></i> ‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
        <button class="btn" id="btnGoDailyScores"><i class="fa-solid fa-trophy"></i> ‡∏î‡∏π‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</button>
      </div>
    </div>
  </div>

  <!-- DAILY SCORES DASHBOARD -->
  <div class="card" id="secDailyScores" style="display:none">
    <div class="hd">‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô - <span id="teamALabelDaily">‡∏ó‡∏µ‡∏° A</span> vs <span id="teamBLabelDaily">‡∏ó‡∏µ‡∏° B</span></div>
    <div class="bd">
      <div class="flex" style="justify-content: space-between; align-items: center; margin-bottom: 16px;">
        <div>
          <div class="h1" style="font-size: 24px; margin: 0;">üèÜ ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</div>
          <div class="muted">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô</div>
        </div>
        <div class="flex">
          <button class="btn" id="btnBackToInsightsFromDaily"><i class="fa-solid fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å</button>
        </div>
      </div>

      <!-- Statistics Summary -->
      <div class="grid2" style="margin-bottom: 20px;">
        <div class="card" style="margin: 0;">
          <div class="hd" id="teamAStatsHeader">‡∏ó‡∏µ‡∏° A - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</div>
          <div class="bd">
            <div id="teamAStats" class="muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
          </div>
        </div>
        <div class="card" style="margin: 0;">
          <div class="hd" id="teamBStatsHeader">‡∏ó‡∏µ‡∏° B - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</div>
          <div class="bd">
            <div id="teamBStats" class="muted">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
          </div>
        </div>
      </div>

      <!-- Daily Scores Chart -->
      <div class="card" style="margin-bottom: 16px;">
        <div class="hd">üìà ‡∏Å‡∏£‡∏≤‡∏ü‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</div>
        <div class="bd">
          <canvas id="chartDailyScores" height="200"></canvas>
        </div>
      </div>

      <!-- Daily Scores Table -->
      <div class="card">
        <div class="hd">üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</div>
        <div class="bd">
          <div style="overflow-x: auto;">
            <table style="width: 100%;">
              <thead>
                <tr>
                  <th style="text-align: left;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                  <th>‡∏ó‡∏µ‡∏°</th>
                  <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</th>
                  <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</th>
                  <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</th>
                  <th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î</th>
                  <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                </tr>
              </thead>
              <tbody id="dailyScoresTable">
                <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏î‡∏¢ JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="flex" style="margin-top: 16px; justify-content: space-between;">
        <div class="muted" id="lastUpdateText">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: -</div>
        <button class="btn ghost" id="btnRefreshDaily"><i class="fa-solid fa-rotate"></i> ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      </div>
    </div>
  </div>
</div>

<script>
// ===== Configuration =====
const tz = 'Asia/Bangkok';
const byId = id => document.getElementById(id);
const setTextSafe = (id, text) => { const el = byId(id); if(el) el.textContent = text; };
const bind = (id, ev, fn) => { const el = byId(id); if(el) el.addEventListener(ev, fn); };
const fmtTime = iso => !iso?'-': new Date(iso).toLocaleString('th-TH',{timeZone:tz,hour:'2-digit',minute:'2-digit'});
const nowTick = () => setTextSafe('nowTH', new Date().toLocaleString('th-TH',{ timeZone: tz }));

// ===== Current Date - 31/10/2568 =====
const currentDate = new Date(2025, 9, 31); // 31 ‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° 2568
const currentDateStr = '31/10/2568';

// ===== Theme & Initialization =====
document.addEventListener('DOMContentLoaded', () => {
  setInterval(nowTick, 1000);
  nowTick();
  
  const themeSel = byId('theme');
  if(themeSel){
    const saved = localStorage.getItem('theme')||'default';
    themeSel.value = saved;
    applyTheme(saved);
    themeSel.addEventListener('change',e=>applyTheme(e.target.value));
  }
  
  // Load settings
  ['webapp','webappA','webappB','limit','plant','size','lightCond','airflow','ac','name','interval','demo','teamNameA','teamNameB'].forEach(id=>{
    const el = byId(id); if(!el) return;
    const v = localStorage.getItem('gs_'+id); 
    if(v !== null) el.value = v;
    el.addEventListener('change',e=> {
      localStorage.setItem('gs_'+id, e.target.value);
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
      updateRealTimeData();
    });
    el.addEventListener('input',e=> {
      localStorage.setItem('gs_'+id, e.target.value);
      // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏°‡∏û‡πå
      updateRealTimeData();
    });
  });
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
  updateRealTimeData();
});

const applyTheme = v => { 
  document.body.className=''; 
  if(v && v!=='default') document.body.classList.add('theme-'+v); 
  localStorage.setItem('theme',v||'default'); 
};

// ===== Real-time Data Update =====
function updateRealTimeData() {
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°
  const teamNameA = byId('teamNameA').value || '‡∏ó‡∏µ‡∏° A';
  const teamNameB = byId('teamNameB').value || '‡∏ó‡∏µ‡∏° B';
  const plantName = byId('plant').value || '‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πà‡∏≤';
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß
  setTextSafe('headerSubtitle', `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå | ${teamNameA} vs ${teamNameB}`);
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÉ‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
  setTextSafe('teamALabel', teamNameA);
  setTextSafe('teamBLabel', teamNameB);
  setTextSafe('teamAName', teamNameA);
  setTextSafe('teamBName', teamNameB);
  setTextSafe('plantLabel', plantName);
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å
  setTextSafe('plantLabelInsights', plantName);
  setTextSafe('teamAHealthHeader', `${teamNameA} ‚Äî ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ`);
  setTextSafe('teamBHealthHeader', `${teamNameB} ‚Äî ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ`);
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô
  setTextSafe('teamALabelDaily', teamNameA);
  setTextSafe('teamBLabelDaily', teamNameB);
  setTextSafe('teamAStatsHeader', `${teamNameA} - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥`);
  setTextSafe('teamBStatsHeader', `${teamNameB} - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥`);
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• AI Advice ‡∏ï‡∏≤‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏°‡πâ
  updatePlantSpecificAdvice(plantName);
}

function updatePlantSpecificAdvice(plantName) {
  let adviceA, adviceB;
  
  // ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
  const aTemp = byId('a_temp').textContent || '25.3';
  const bTemp = byId('b_temp').textContent || '24.8';
  const aSoil = byId('a_soil').textContent || '68';
  const bSoil = byId('b_soil').textContent || '72';
  const aLight = byId('a_light').textContent || '72';
  const bLight = byId('b_light').textContent || '69';
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏°‡πâ‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
  const plantAdvice = getPlantAdvice(plantName, aTemp, bTemp, aSoil, bSoil, aLight, bLight);
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏ô AI Advice ‡∏ó‡∏±‡πâ‡∏á‡πÉ‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å
  byId('aiAdviceContentDashA').textContent = plantAdvice.adviceA;
  byId('aiAdviceContentDashB').textContent = plantAdvice.adviceB;
  byId('aiAdviceContentA').textContent = plantAdvice.adviceA;
  byId('aiAdviceContentB').textContent = plantAdvice.adviceB;
  
  // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó
  showAIUpdateIndicator();
}

function getPlantAdvice(plantName, aTemp, bTemp, aSoil, bSoil, aLight, bLight) {
  let adviceA, adviceB;
  
  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏°‡πâ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏≤‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå
  const plantLower = plantName.toLowerCase();
  
  if (plantLower.includes('‡∏¢‡∏≤‡∏á') || plantLower.includes('‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢')) {
    adviceA = `üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏≤‡∏á‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢ (‡∏ó‡∏µ‡∏° A):
- ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ ${aTemp}¬∞C ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏≤‡∏á‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô ${aSoil}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°
- ‡πÅ‡∏™‡∏á ${aLight}% ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï
- ‡∏£‡∏∞‡∏î‡∏±‡∏ö PM2.5 18 ¬µg/m¬≥ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ

‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: 
‚úÖ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞ 1-2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
‚úÖ ‡∏´‡∏°‡∏±‡πà‡∏ô‡πÄ‡∏ä‡πá‡∏î‡πÉ‡∏ö‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏™‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏µ
‚úÖ ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏á‡∏£‡∏≥‡πÑ‡∏£
‚úÖ ‡∏´‡∏°‡∏∏‡∏ô‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥`;

    adviceB = `üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏≤‡∏á‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢ (‡∏ó‡∏µ‡∏° B):
- ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ ${bTemp}¬∞C ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏≤‡∏á‡∏≠‡∏¥‡∏ô‡πÄ‡∏î‡∏µ‡∏¢
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô ${bSoil}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡∏°‡∏≤‡∏Å
- ‡πÅ‡∏™‡∏á ${bLight}% ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡πÅ‡∏ï‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
- ‡∏£‡∏∞‡∏î‡∏±‡∏ö PM2.5 22 ¬µg/m¬≥ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ

‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:
‚úÖ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏î‡∏¥‡∏ô‡πÅ‡∏´‡πâ‡∏á 1-2 ‡∏ô‡∏¥‡πâ‡∏ß‡∏ö‡∏ô
‚úÖ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏á‡πÅ‡∏î‡∏î‡∏à‡∏±‡∏î
‚úÖ ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πã‡∏¢‡∏ô‡πâ‡∏≥‡∏ó‡∏∏‡∏Å 2 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏°‡∏•‡∏á‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡∏∑‡∏ä‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥`;
  }
  else if (plantLower.includes('‡∏•‡∏¥‡πâ‡∏ô') || plantLower.includes('‡∏°‡∏±‡∏á‡∏Å‡∏£')) {
    adviceA = `üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡πâ‡∏ô‡∏°‡∏±‡∏á‡∏Å‡∏£ (‡∏ó‡∏µ‡∏° A):
- ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ ${aTemp}¬∞C ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡πâ‡∏ô‡∏°‡∏±‡∏á‡∏Å‡∏£
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô ${aSoil}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°
- ‡πÅ‡∏™‡∏á ${aLight}% ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï
- ‡∏£‡∏∞‡∏î‡∏±‡∏ö PM2.5 18 ¬µg/m¬≥ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ

‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: 
‚úÖ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏ó‡∏∏‡∏Å 2-3 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
‚úÖ ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏á‡∏£‡∏≥‡πÑ‡∏£‡∏ñ‡∏∂‡∏á‡πÅ‡∏î‡∏î‡∏à‡∏±‡∏î
‚úÖ ‡∏ó‡∏ô‡πÅ‡∏•‡πâ‡∏á‡πÑ‡∏î‡πâ‡∏î‡∏µ ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏ö‡πà‡∏≠‡∏¢
‚úÖ ‡πÉ‡∏ä‡πâ‡∏î‡∏¥‡∏ô‡∏ú‡∏™‡∏°‡∏ó‡∏£‡∏≤‡∏¢‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏î‡∏µ`;

    adviceB = `üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡πâ‡∏ô‡∏°‡∏±‡∏á‡∏Å‡∏£ (‡∏ó‡∏µ‡∏° B):
- ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ ${bTemp}¬∞C ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡πâ‡∏ô‡∏°‡∏±‡∏á‡∏Å‡∏£
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô ${bSoil}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡∏°‡∏≤‡∏Å
- ‡πÅ‡∏™‡∏á ${bLight}% ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡πÅ‡∏ï‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
- ‡∏£‡∏∞‡∏î‡∏±‡∏ö PM2.5 22 ¬µg/m¬≥ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ

‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:
‚úÖ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏ô‡πâ‡∏≠‡∏¢‡πÅ‡∏ï‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠
‚úÖ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏ô‡∏î‡∏¥‡∏ô‡πÅ‡∏â‡∏∞
‚úÖ ‡∏ó‡∏ô‡∏ï‡πà‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏î‡∏µ
‚úÖ ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πã‡∏¢‡∏≠‡πà‡∏≠‡∏ô‡πÜ ‡∏ó‡∏∏‡∏Å 3 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô`;
  }
  else if (plantLower.includes('‡∏û‡∏•‡∏π') || plantLower.includes('‡∏î‡πà‡∏≤‡∏á')) {
    adviceA = `üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏•‡∏π‡∏î‡πà‡∏≤‡∏á (‡∏ó‡∏µ‡∏° A):
- ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ ${aTemp}¬∞C ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏•‡∏π‡∏î‡πà‡∏≤‡∏á
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô ${aSoil}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°
- ‡πÅ‡∏™‡∏á ${aLight}% ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï
- ‡∏£‡∏∞‡∏î‡∏±‡∏ö PM2.5 18 ¬µg/m¬≥ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ

‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: 
‚úÖ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
‚úÖ ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏á‡∏£‡∏≥‡πÑ‡∏£
‚úÖ ‡∏´‡∏°‡∏±‡πà‡∏ô‡∏ï‡∏±‡∏î‡πÄ‡∏•‡πá‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡∏Å‡∏Å‡∏≠
‚úÖ ‡∏õ‡∏•‡∏π‡∏Å‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á‡πÅ‡∏Ç‡∏ß‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ`;

    adviceB = `üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏•‡∏π‡∏î‡πà‡∏≤‡∏á (‡∏ó‡∏µ‡∏° B):
- ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ ${bTemp}¬∞C ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏•‡∏π‡∏î‡πà‡∏≤‡∏á
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô ${bSoil}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡∏°‡∏≤‡∏Å
- ‡πÅ‡∏™‡∏á ${bLight}% ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡πÅ‡∏ï‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
- ‡∏£‡∏∞‡∏î‡∏±‡∏ö PM2.5 22 ¬µg/m¬≥ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ

‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:
‚úÖ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏î‡∏¥‡∏ô‡πÅ‡∏´‡πâ‡∏á‡∏ú‡∏¥‡∏ß
‚úÖ ‡∏´‡∏°‡∏±‡πà‡∏ô‡∏û‡πà‡∏ô‡∏•‡∏∞‡∏≠‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡πÉ‡∏ö
‚úÖ ‡∏ï‡∏±‡∏î‡∏Å‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏≤‡∏ß‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏°‡∏≤‡∏õ‡∏±‡∏Å‡∏ä‡∏≥
‚úÖ ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πã‡∏¢‡∏ô‡πâ‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á`;
  }
  else {
    // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ
    adviceA = `üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö${plantName} (‡∏ó‡∏µ‡∏° A):
- ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ ${aTemp}¬∞C ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö${plantName}
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô ${aSoil}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°
- ‡πÅ‡∏™‡∏á ${aLight}% ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï
- ‡∏£‡∏∞‡∏î‡∏±‡∏ö PM2.5 18 ¬µg/m¬≥ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ

‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: 
‚úÖ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå‡∏•‡∏∞ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
‚úÖ ‡∏´‡∏°‡∏±‡πà‡∏ô‡∏û‡πà‡∏ô‡∏•‡∏∞‡∏≠‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡πÉ‡∏ö
‚úÖ ‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏á‡∏£‡∏≥‡πÑ‡∏£
‚úÖ ‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏û‡∏¢‡∏∏‡∏á‡∏•‡∏≥‡∏ï‡πâ‡∏ô`;

    adviceB = `üí° ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö${plantName} (‡∏ó‡∏µ‡∏° B):
- ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ ${bTemp}¬∞C ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö${plantName}
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô ${bSoil}% ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡∏°‡∏≤‡∏Å
- ‡πÅ‡∏™‡∏á ${bLight}% ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡πÅ‡∏ï‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
- ‡∏£‡∏∞‡∏î‡∏±‡∏ö PM2.5 22 ¬µg/m¬≥ ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ

‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:
‚úÖ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏î‡∏¥‡∏ô‡πÅ‡∏´‡πâ‡∏á 1-2 ‡∏ô‡∏¥‡πâ‡∏ß‡∏ö‡∏ô
‚úÖ ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏á‡πÅ‡∏î‡∏î‡∏à‡∏±‡∏î
‚úÖ ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πã‡∏¢‡∏ô‡πâ‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á
‚úÖ ‡∏´‡∏°‡∏∏‡∏ô‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠`;
  }
  
  return { adviceA, adviceB };
}

function showAIUpdateIndicator() {
  // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó
  const indicators = [
    'aiUpdateIndicatorDashA', 'aiUpdateIndicatorDashB',
    'aiUpdateIndicatorA', 'aiUpdateIndicatorB'
  ];
  
  indicators.forEach(id => {
    const indicator = byId(id);
    if (indicator) {
      indicator.style.display = 'inline';
      setTimeout(() => {
        indicator.style.display = 'none';
      }, 3000);
    }
  });
}

// ===== Navigation =====
function show(id) { 
  ['secForm','secDash','secInsights','secDailyScores'].forEach(x => { 
    const el = byId(x); 
    if(el) el.style.display = (x === id) ? 'block' : 'none'; 
  }); 
}

bind('navForm','click', () => show('secForm'));
bind('navDash','click', () => show('secDash'));
bind('navInsight','click', () => { 
  show('secInsights'); 
  initHeartChart();
  renderInsights();
});
bind('navDailyScores','click', () => { 
  show('secDailyScores'); 
  loadDailyScores();
});
bind('btnGoInsights','click', () => { 
  show('secInsights'); 
  initHeartChart();
  renderInsights();
});
bind('btnBackDash','click', () => show('secDash'));
bind('btnGoDailyScores','click', () => { 
  show('secDailyScores'); 
  loadDailyScores();
});
bind('btnBackToInsightsFromDaily','click', () => show('secInsights'));

// ===== Reset =====
bind('btnReset','click', () => {
  if(confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?')) {
    localStorage.clear();
    location.reload();
  }
});

// ===== Start System =====
bind('btnStart','click', () => {
  const teamNameA = byId('teamNameA').value || '‡∏ó‡∏µ‡∏° A';
  const teamNameB = byId('teamNameB').value || '‡∏ó‡∏µ‡∏° B';
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°
  byId('teamALabel').textContent = teamNameA;
  byId('teamBLabel').textContent = teamNameB;
  
  // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
  localStorage.setItem('gs_profile_done', '1');
  
  show('secDash');
  byId('statusText').textContent = '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß';
  byId('dot').className = 'dot ok';
  
  // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
  generateDemoData();
});

// ===== Generate Demo Data =====
function generateDemoData() {
  // ‡∏™‡∏∏‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ã‡∏ô‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏µ
  const aTemp = (25 + (Math.random() - 0.5)).toFixed(1);
  const bTemp = (24.8 + (Math.random() - 0.5)).toFixed(1);
  const aHum = Math.max(55, Math.min(70, 62 + Math.floor(Math.random() * 6 - 3)));
  const bHum = Math.max(55, Math.min(70, 65 + Math.floor(Math.random() * 6 - 3)));
  const aSoil = Math.max(60, Math.min(75, 68 + Math.floor(Math.random() * 8 - 4)));
  const bSoil = Math.max(60, Math.min(75, 72 + Math.floor(Math.random() * 8 - 4)));
  const aLight = Math.max(65, Math.min(80, 72 + Math.floor(Math.random() * 10 - 5)));
  const bLight = Math.max(60, Math.min(78, 69 + Math.floor(Math.random() * 10 - 5)));
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó KPI
  setTextSafe('a_temp', aTemp);
  setTextSafe('b_temp', bTemp);
  setTextSafe('a_hum', aHum);
  setTextSafe('b_hum', bHum);
  setTextSafe('a_soil', aSoil);
  setTextSafe('b_soil', bSoil);
  setTextSafe('a_light', aLight);
  setTextSafe('b_light', bLight);
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
  const aScore = 7 + Math.random() * 1.5; // 7-8.5
  const bScore = 6.5 + Math.random() * 1.5; // 6.5-8
  
  updateHeartsDisplay('a', aScore);
  updateHeartsDisplay('b', bScore);
  
  // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á
  generateTableData();
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ AI ‡∏ï‡∏≤‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏°‡πâ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
  const plantName = byId('plant').value || '‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πà‡∏≤';
  updatePlantSpecificAdvice(plantName);
}

function updateHeartsDisplay(team, score) {
  const hearts = '‚ù§Ô∏è'.repeat(Math.max(1, Math.min(10, Math.round(score))));
  const specialHearts = score >= 7 ? 'üíñ'.repeat(Math.round(score)) : '';
  const status = getStatusText(score);
  
  setTextSafe(`${team}_hearts`, hearts);
  setTextSafe(`${team}_special_hearts`, specialHearts);
  setTextSafe(`${team}_status`, status);
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
  const advice = getAdviceText(team, score);
  setTextSafe(`${team}_advice`, advice);
}

function getStatusText(score) {
  if (score >= 8) return '‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° üéâ';
  if (score >= 7) return '‡∏î‡∏µ‡∏°‡∏≤‡∏Å üëç';
  if (score >= 6) return '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‚úÖ';
  if (score >= 5) return '‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π‡πÅ‡∏• ‚ö†Ô∏è';
  return '‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢ üö®';
}

function getAdviceText(team, score) {
  if (score >= 8) return '‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏°‡∏≤‡∏Å! ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°';
  if (score >= 7) return '‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡∏µ ‡πÅ‡∏™‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏£‡∏î‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏±‡πà‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏î‡∏¥‡∏ô';
  if (score >= 6) return '‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏û‡∏≠‡πÉ‡∏ä‡πâ ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°';
  return '‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
}

function generateTableData() {
  const times = ['14:30', '14:15', '14:00', '13:45', '13:30', '13:15', '13:00', '12:45'];
  
  // ‡∏™‡∏∏‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡∏° A
  let aHtml = '';
  times.forEach(time => {
    const temp = (24.5 + Math.random() * 1.5).toFixed(1);
    const hum = Math.floor(58 + Math.random() * 12);
    const soil = Math.floor(63 + Math.random() * 12);
    const light = Math.floor(67 + Math.random() * 10);
    aHtml += `<tr><td>${time}</td><td style="text-align:center">${temp}</td><td style="text-align:center">${hum}</td><td style="text-align:center">${soil}</td><td style="text-align:center">${light}</td></tr>`;
  });
  byId('a_tbl').innerHTML = aHtml;
  
  // ‡∏™‡∏∏‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡∏° B
  let bHtml = '';
  times.forEach(time => {
    const temp = (24.3 + Math.random() * 1.4).toFixed(1);
    const hum = Math.floor(60 + Math.random() * 10);
    const soil = Math.floor(67 + Math.random() * 10);
    const light = Math.floor(64 + Math.random() * 12);
    bHtml += `<tr><td>${time}</td><td style="text-align:center">${temp}</td><td style="text-align:center">${hum}</td><td style="text-align:center">${soil}</td><td style="text-align:center">${light}</td></tr>`;
  });
  byId('b_tbl').innerHTML = bHtml;
}

// ===== Refresh Data =====
bind('btnRefresh','click', () => {
  generateDemoData();
  
  // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó
  showStatusMessage('‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'secDash');
});

// ===== AI Advice =====
bind('btnGetAIAdvice','click', () => {
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏≤‡∏°‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÑ‡∏°‡πâ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
  const plantName = byId('plant').value || '‡∏°‡∏≠‡∏ô‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πà‡∏≤';
  updatePlantSpecificAdvice(plantName);
  
  // ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ AI
  byId('aiAdviceDashA').style.display = 'block';
  byId('aiAdviceDashB').style.display = 'block';
  byId('aiAdviceA').style.display = 'block';
  byId('aiAdviceB').style.display = 'block';
  
  showStatusMessage('‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å AI ‡πÅ‡∏•‡πâ‡∏ß', 'secDash');
});

// ===== Refresh Daily Scores =====
bind('btnRefreshDaily','click', () => {
  loadDailyScores();
  showStatusMessage('‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'secDailyScores');
});

// ===== Daily Scores Management =====
let dailyScoresChart = null;

function loadDailyScores() {
  // ‡∏™‡∏∏‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 7 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
  const scores = [];
  const dates = ['24/10/2568', '25/10/2568', '26/10/2568', '27/10/2568', '28/10/2568', '29/10/2568', '30/10/2568', '31/10/2568'];
  
  dates.forEach(date => {
    const scoreA = (7 + Math.random() * 1.5).toFixed(1);
    const scoreB = (6.5 + Math.random() * 1.5).toFixed(1);
    
    scores.push({
      ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: date,
      ‡∏ó‡∏µ‡∏°: 'A',
      ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: scoreA,
      ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: Math.floor(6 + Math.random() * 4),
      ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: (parseFloat(scoreA) + 0.3).toFixed(1),
      ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î: (parseFloat(scoreA) - 0.4).toFixed(1),
      ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: getStatusText(parseFloat(scoreA))
    });
    
    scores.push({
      ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: date,
      ‡∏ó‡∏µ‡∏°: 'B',
      ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: scoreB,
      ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: Math.floor(6 + Math.random() * 4),
      ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: (parseFloat(scoreB) + 0.3).toFixed(1),
      ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î: (parseFloat(scoreB) - 0.4).toFixed(1),
      ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: getStatusText(parseFloat(scoreB))
    });
  });
  
  renderDailyScores(scores);
  setTextSafe('lastUpdateText', `‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date().toLocaleString('th-TH', {timeZone: tz})}`);
}

function renderDailyScores(scores) {
  const teamAScores = scores.filter(score => score.‡∏ó‡∏µ‡∏° === 'A');
  const teamBScores = scores.filter(score => score.‡∏ó‡∏µ‡∏° === 'B');
  
  updateTeamStats('A', teamAScores);
  updateTeamStats('B', teamBScores);
  
  renderDailyScoresChart(teamAScores, teamBScores);
  renderDailyScoresTable(scores);
}

function updateTeamStats(team, scores) {
  if (scores.length === 0) {
    setTextSafe(`team${team}Stats`, '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
    return;
  }
  
  const latestScore = scores[scores.length - 1];
  const avgScore = scores.reduce((sum, score) => sum + parseFloat(score['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢']), 0) / scores.length;
  const maxScore = Math.max(...scores.map(score => parseFloat(score['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î'])));
  const minScore = Math.min(...scores.map(score => parseFloat(score['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î'])));
  const totalDataPoints = scores.reduce((sum, score) => sum + parseInt(score['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•']), 0);
  
  const statsHTML = `
    <div style="margin-bottom: 8px;">
      <strong>‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (${latestScore.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà}):</strong> ${latestScore['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢']} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
      <span class="status-badge ${getStatusClass(latestScore.‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞)}">${latestScore.‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞}</span>
    </div>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 13px;">
      <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: <strong>${avgScore.toFixed(2)}</strong></div>
      <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <strong>${maxScore.toFixed(1)}</strong></div>
      <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î: <strong>${minScore.toFixed(1)}</strong></div>
      <div>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô: <strong>${scores.length}</strong></div>
    </div>
    <div style="margin-top: 8px; font-size: 12px; color: var(--muted);">
      ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${totalDataPoints} ‡∏à‡∏∏‡∏î
    </div>
  `;
  
  setTextSafe(`team${team}Stats`, '');
  byId(`team${team}Stats`).innerHTML = statsHTML;
}

function getStatusClass(status) {
  if (status.includes('‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°')) return 'status-excellent';
  if (status.includes('‡∏î‡∏µ‡∏°‡∏≤‡∏Å')) return 'status-good';
  if (status.includes('‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á')) return 'status-fair';
  if (status.includes('‡∏ï‡πâ‡∏≠‡∏á‡∏î‡∏π‡πÅ‡∏•')) return 'status-poor';
  return 'status-critical';
}

function renderDailyScoresChart(teamAScores, teamBScores) {
  const canvas = byId('chartDailyScores');
  if (!canvas) return;
  
  const ctx = canvas.getContext('2d');
  if (dailyScoresChart) dailyScoresChart.destroy();
  
  const labels = teamAScores.map(score => score.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà.split('/')[0] + '/' + score.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà.split('/')[1]);
  const dataA = teamAScores.map(score => parseFloat(score['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢']));
  const dataB = teamBScores.map(score => parseFloat(score['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢']));
  
  dailyScoresChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: labels,
      datasets: [
        {
          label: '‡∏ó‡∏µ‡∏° A',
          data: dataA,
          borderColor: '#10b981',
          backgroundColor: '#10b98120',
          tension: 0.3,
          fill: false
        },
        {
          label: '‡∏ó‡∏µ‡∏° B',
          data: dataB,
          borderColor: '#8b5cf6',
          backgroundColor: '#8b5cf620',
          tension: 0.3,
          fill: false
        }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: true,
          position: 'top'
        },
        tooltip: {
          mode: 'index',
          intersect: false
        }
      },
      scales: {
        y: {
          min: 5,
          max: 9,
          ticks: {
            stepSize: 0.5
          },
          title: {
            display: true,
            text: '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô'
          }
        },
        x: {
          title: {
            display: true,
            text: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'
          }
        }
      }
    }
  });
}

function renderDailyScoresTable(scores) {
  const tableBody = byId('dailyScoresTable');
  if (!tableBody) return;
  
  const sortedScores = [...scores].sort((a, b) => {
    const dateA = a.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà.split('/').reverse().join('');
    const dateB = b.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà.split('/').reverse().join('');
    return dateB.localeCompare(dateA);
  });
  
  if (sortedScores.length === 0) {
    tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px;" class="muted">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</td></tr>';
    return;
  }
  
  let html = '';
  sortedScores.forEach(score => {
    const statusClass = getStatusClass(score.‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞);
    html += `
      <tr>
        <td>${score.‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà}</td>
        <td style="text-align: center;">‡∏ó‡∏µ‡∏° ${score.‡∏ó‡∏µ‡∏°}</td>
        <td style="text-align: center;"><strong>${score['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢']}</strong></td>
        <td style="text-align: center;">${score['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•']}</td>
        <td style="text-align: center;">${score['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î']}</td>
        <td style="text-align: center;">${score['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î']}</td>
        <td style="text-align: center;"><span class="status-badge ${statusClass}">${score.‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞}</span></td>
      </tr>
    `;
  });
  
  tableBody.innerHTML = html;
}

// ===== Insights =====
let heartChart = null;

function initHeartChart() {
  const canvas = byId('chartHearts');
  if(!canvas) return;
  
  const ctx = canvas.getContext('2d');
  if(heartChart) heartChart.destroy();
  
  // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û 8 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
  const labels = ['06:00', '08:00', '10:00', '12:00', '14:00', '16:00', '18:00', '20:00'];
  const dataA = [7.2, 7.5, 7.8, 8.0, 8.2, 8.1, 7.9, 7.8];
  const dataB = [6.8, 7.0, 7.3, 7.5, 7.8, 7.7, 7.6, 7.5];
  
  heartChart = new Chart(ctx, {
    type: 'line',
    data: { 
      labels, 
      datasets: [
        { 
          label: '‡∏ó‡∏µ‡∏° A', 
          data: dataA, 
          tension: 0.25, 
          pointRadius: 3, 
          borderWidth: 2, 
          borderColor: '#10b981', 
          backgroundColor: '#10b98120', 
          fill: false 
        },
        { 
          label: '‡∏ó‡∏µ‡∏° B', 
          data: dataB, 
          tension: 0.25, 
          pointRadius: 3, 
          borderWidth: 2, 
          borderColor: '#8b5cf6', 
          backgroundColor: '#8b5cf620', 
          fill: false 
        }
      ]
    },
    options: { 
      responsive: true, 
      scales: { 
        y: { 
          suggestedMin: 5, 
          suggestedMax: 10, 
          ticks: { stepSize: 1 } 
        } 
      }, 
      plugins: { 
        legend: { display: true },
        tooltip: { enabled: true } 
      } 
    }
  });
}

function renderInsights() {
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û
  byId('healthA').innerHTML = getHealthHTML('A');
  byId('healthB').innerHTML = getHealthHTML('B');
  
  // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ
  byId('dailyTable').innerHTML = getDailyTableHTML();
  byId('weeklyTable').innerHTML = getWeeklyTableHTML();
}

function getHealthHTML(team) {
  const temp = team === 'A' ? '25.3' : '24.8';
  const hum = team === 'A' ? '62' : '65';
  const soil = team === 'A' ? '68' : '72';
  const light = team === 'A' ? '72' : '69';
  const pm25 = team === 'A' ? '18' : '22';
  
  return `
    <div class="chips">
      <span class="chip">‡πÄ‡∏ß‡∏•‡∏≤: 14:30</span>
      <span class="chip">PM2.5: ${pm25} ¬µg/m¬≥ (‡∏î‡∏µ‡∏°‡∏≤‡∏Å)</span>
      <span class="chip">RH: ${hum}%</span>
      <span class="chip">Temp: ${temp}¬∞C</span>
      <span class="chip">Light: ${light}%</span>
    </div>
    <div style="margin-top:8px">
      <div><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û:</strong></div>
      <ul style="margin:6px 0 0 18px; font-size:14px;">
        <li>‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏î‡∏µ ‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÑ‡∏î‡πâ</li>
        <li>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</li>
        <li>‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</li>
        <li>‡πÅ‡∏™‡∏á‡∏î‡∏µ ‚Äî ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï</li>
      </ul>
    </div>
  `;
}

function getDailyTableHTML() {
  return `
    <table style="width:100%; font-size:11px;">
      <thead>
        <tr><th style="text-align:left">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏ó‡∏µ‡∏° A</th><th>‡∏ó‡∏µ‡∏° B</th></tr>
      </thead>
      <tbody>
        <tr><td>31/10/2568</td><td style="text-align:center">8.2</td><td style="text-align:center">7.8</td></tr>
        <tr><td>30/10/2568</td><td style="text-align:center">8.0</td><td style="text-align:center">7.5</td></tr>
        <tr><td>29/10/2568</td><td style="text-align:center">7.9</td><td style="text-align:center">7.6</td></tr>
        <tr><td>28/10/2568</td><td style="text-align:center">8.1</td><td style="text-align:center">7.7</td></tr>
      </tbody>
    </table>
  `;
}

function getWeeklyTableHTML() {
  return `
    <table style="width:100%; font-size:11px;">
      <thead>
        <tr><th style="text-align:left">‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</th><th>‡∏ó‡∏µ‡∏° A</th><th>‡∏ó‡∏µ‡∏° B</th></tr>
      </thead>
      <tbody>
        <tr><td>43/2568</td><td style="text-align:center">8.0</td><td style="text-align:center">7.6</td></tr>
        <tr><td>42/2568</td><td style="text-align:center">7.8</td><td style="text-align:center">7.4</td></tr>
        <tr><td>41/2568</td><td style="text-align:center">7.5</td><td style="text-align:center">7.2</td></tr>
        <tr><td>40/2568</td><td style="text-align:center">7.3</td><td style="text-align:center">7.0</td></tr>
      </tbody>
    </table>
  `;
}

// ===== AI Advice Toggle =====
document.addEventListener('click', function(e) {
  if (e.target.closest('.ai-advice-header') || e.target.closest('.ai-advice-toggle')) {
    const aiAdvice = e.target.closest('.ai-advice');
    if (aiAdvice) {
      const isCollapsed = aiAdvice.classList.contains('collapsed');
      const toggleBtn = aiAdvice.querySelector('.ai-advice-toggle i');
      
      if (isCollapsed) {
        aiAdvice.classList.remove('collapsed');
        aiAdvice.classList.add('expanded');
        toggleBtn.className = 'fa-solid fa-chevron-up';
      } else {
        aiAdvice.classList.remove('expanded');
        aiAdvice.classList.add('collapsed');
        toggleBtn.className = 'fa-solid fa-chevron-down';
      }
    }
  }
});

// ===== Utility Functions =====
function showStatusMessage(message, section) {
  const statusEl = document.createElement('div');
  statusEl.className = 'ok';
  statusEl.style.marginTop = '8px';
  statusEl.style.fontSize = '12px';
  statusEl.textContent = message;
  
  const existingStatus = document.querySelector('.update-status');
  if(existingStatus) existingStatus.remove();
  
  statusEl.className = 'update-status ok';
  document.querySelector(`#${section} .bd:last-child`).appendChild(statusEl);
  
  setTimeout(() => {
    if(statusEl.parentNode) statusEl.parentNode.removeChild(statusEl);
  }, 3000);
}

// ===== Initialize =====
document.addEventListener('DOMContentLoaded', () => {
  console.log('üåø GreenSync Duel - ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
  console.log('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå');
});
</script>
</body>
</html>